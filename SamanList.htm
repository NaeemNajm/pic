<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ржЗржирзНржЯрж╛рж░рзЗржХрзНржЯрж┐ржн ржЙржорж░рж╛рж╣ ржЪрзЗржХрж▓рж┐рж╕рзНржЯ - ржЖрж▓-рж╣рж┐ржХржорж╛рж╣ ржЯрзНржпрзБрж░ ржЕрзНржпрж╛ржирзНржб ржЯрзНрж░рж╛ржнрзЗрж▓рж╕</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Mecca Twilight -->
    <!-- Application Structure Plan: The application uses a tab-based navigation structure. This design was chosen to break down the long checklist from the source report into logical, manageable categories (e.g., Essentials, Men's, Women's). This prevents user overload and allows for focused preparation. Users can click on a tab to view the specific list, and interact with items by checking them off. A new summary section dynamically displays checked items. Download buttons for both the full list and the checked list (as PDF/JPG) have been added to provide users with offline-accessible versions of their lists. This structure directly serves the user's primary goal: to systematically pack for their journey and have a record of it. -->
    <!-- Visualization & Content Choices: Report Info: The source is a categorized checklist for Umrah. Goal: To create a practical, interactive packing tool with download functionality. Viz/Presentation Method: The information is presented in interactive lists within a tabbed interface. A new dynamic list shows checked items. Interaction: Users can click tabs, check/uncheck items. Checking an item adds it to a summary list. Download buttons trigger client-side generation of PDF/JPG files. Justification: This transforms a static document into a functional application. The download feature is a significant enhancement, allowing users to save or print their lists. Library/Method: Vanilla JS for logic, Tailwind CSS for styling, jsPDF and html2canvas for download functionality. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Hind Siliguri', sans-serif;
            background-color: #F0F2F5;
        }
        .tab-active {
            background-color: #2D3748; /* Gray 800 */
            color: white;
            border-color: #1A202C;
            box-shadow: 0 4px 14px 0 rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        .tab-inactive {
            background-color: #E2E8F0;
            color: #2D3748;
            border-color: #CBD5E0;
        }
        .content-panel { display: none; }
        .content-panel.active { display: block; }
        .checklist-item input:checked + label {
            text-decoration: line-through;
            color: #A0AEC0;
        }
        .checklist-item label {
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }
        .essential-item {
            color: #C53030; /* Red-700 */
            font-weight: 600;
        }
        .bag-tag {
            font-size: 0.75rem;
            font-weight: 500;
            padding: 2px 8px;
            border-radius: 9999px;
            margin-left: 8px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            line-height: 1.2;
        }
        .bag-hand {
            background-color: #EBF4FF;
            color: #3182CE;
            border: 1px solid #90CDF4;
        }
        .bag-luggage {
            background-color: #FEEBC8;
            color: #DD6B20;
            border: 1px solid #FBD38D;
        }
        .action-button {
            background-image: linear-gradient(to right, #D69E2E 0%, #B7791F 51%, #D69E2E 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            transition: 0.5s;
            background-size: 200% auto;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 14px;
        }
        .action-button:hover {
            background-position: right center;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .action-button:disabled {
            background-image: none;
            background-color: #A0AEC0;
            cursor: not-allowed;
            transform: translateY(0);
            box-shadow: none;
        }
        .printable-area {
            font-family: 'Hind Siliguri', sans-serif;
            position: absolute;
            left: -9999px;
            top: auto;
            width: 840px; /* A4-like width */
            background-color: #ffffff;
            padding: 40px;
            box-sizing: border-box;
            overflow: hidden;
        }
        .watermark-container {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: var(--watermark-url);
            background-repeat: repeat;
            z-index: 0;
        }
        .printable-header, .printable-footer, .printable-content {
            position: relative;
            z-index: 1;
        }
        .printable-header, .printable-footer {
            text-align: center;
            padding-bottom: 20px;
            margin-bottom: 20px;
            border-bottom: 2px solid #2D3748;
        }
        .printable-footer {
            padding-top: 20px;
            margin-top: 20px;
            border-top: 2px solid #2D3748;
            border-bottom: none;
        }
        .printable-header h1, .printable-footer h1 {
             font-size: 28px;
             font-weight: 700;
             color: #1A202C;
        }
        .printable-header p, .printable-footer p {
            font-size: 14px;
            color: #4A5568;
        }
        .printable-content {
            column-count: 2;
            column-gap: 40px;
        }
        .list-break {
            break-before: column;
        }
        .checked-category-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #1A202C;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            background-color: #EDF2F7;
            border-left: 4px solid #2D3748;
            border-radius: 4px;
        }
    </style>
</head>
<body class="antialiased text-gray-800">
    <div class="container mx-auto p-4 md:p-8 max-w-6xl">
        
        <header class="text-center mb-10 bg-white p-8 rounded-3xl shadow-2xl">
            <h1 class="text-6xl md:text-7xl font-bold text-gray-800">ЁЯХЛ</h1>
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mt-2">ржкржмрж┐рждрзНрж░ ржЙржорж░рж╛рж╣ ржпрж╛рждрзНрж░рж╛рж░ ржЪрзЗржХрж▓рж┐рж╕рзНржЯ</h2>
            <div class="mt-4 max-w-2xl mx-auto bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-4 rounded-md" role="alert">
                <p class="font-bold">ржкржмрж┐рждрзНрж░ ржнрзВржорж┐рж░ ржкрзНрж░рждрж┐ржЯрж┐ ржкржжржХрзНрж╖рзЗржкрзЗ ржЖржорж░рж╛ ржерж╛ржХржмрзЛ ржЖржкржирж╛рж░ ржмрж┐рж╢рзНржмрж╕рзНржд рж╕ржЩрзНржЧрзАред</p>
                <p>ржЖрж╕рзБржи, ржЖржорж╛ржжрзЗрж░ рж╕рж╛ржерзЗ рж╢рзБрж░рзБ ржХрж░рзБржи ржЖржкржирж╛рж░ ржЖржзрзНржпрж╛рждрзНржорж┐ржХ ржпрж╛рждрзНрж░рж╛рж░ рж╕рзЗрж░рж╛ ржЕржнрж┐ржЬрзНржЮрждрж╛ред ржЖржкржирж╛рж░ рж╕рзЗржмрж╛ ржХрж░рж╛рж░ рж╕рзБржпрзЛржЧ ржкрзЗрзЯрзЗ ржЖржорж░рж╛ ржЧрж░рзНржмрж┐рждред</p>
            </div>
            
            <div class="mt-6 max-w-2xl mx-auto bg-red-100 border-l-4 border-red-500 text-red-800 p-4 rounded-md" role="alert">
                <p class="font-bold">ржмрж┐рж╢рзЗрж╖ ржжрзНрж░рж╖рзНржЯржмрзНржп: рж╕ржлрж░рзЗ ржпржд ржХржо рж╕рж╛ржорж╛ржи, рждржд ржмрзЗрж╢рж┐ ржЖрж░рж╛ржоред</p>
                <p>ржПржЗ рждрж╛рж▓рж┐ржХрж╛ржЯрж┐ ржЖржкржирж╛ржХрзЗ ржПржХржЯрж┐ ржкрзВрж░рзНржгрж╛ржЩрзНржЧ ржзрж╛рж░ржгрж╛ ржжрзЗржУрзЯрж╛рж░ ржЬржирзНржпред ржЖржкржирж╛рж░ ржкрзНрж░рзЯрзЛржЬржи ржЕржирзБржпрж╛рзЯрзА ржЬрж┐ржирж┐рж╕ржкрждрзНрж░ ржирж┐ржи ржПржмржВ ржЕрждрж┐рж░рж┐ржХрзНржд ржорж╛рж▓рж╛ржорж╛рж▓ ржмрж╣ржи ржХрж░рж╛ ржерзЗржХрзЗ ржмрж┐рж░ржд ржерж╛ржХрзБржиред</p>
            </div>

            <div class="mt-6">
                <input type="text" id="customer-name" placeholder="ржЖржкржирж╛рж░ ржирж╛ржо рж▓рж┐ржЦрзБржи..." class="px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-gray-800 focus:border-gray-800 w-full max-w-sm mx-auto text-center">
            </div>

            <div class="mt-6 p-4 border-t border-gray-200 max-w-2xl mx-auto">
                <h3 class="font-bold text-lg text-gray-700 mb-3 text-center">рж╕ржорзНржкрзВрж░рзНржг рждрж╛рж▓рж┐ржХрж╛</h3>
                <div id="full-list-actions" class="flex justify-center flex-wrap gap-3">
                     <button data-type="full" data-format="pdf" class="action-button download-btn">ржбрж╛ржЙржирж▓рзЛржб (PDF)</button>
                     <button data-type="full" data-format="jpg" class="action-button download-btn">ржбрж╛ржЙржирж▓рзЛржб (JPG)</button>
                     <button data-type="full" class="action-button print-btn">ржкрзНрж░рж┐ржирзНржЯ ржХрж░рзБржи</button>
                     <button data-type="full" class="action-button share-btn">рж╢рзЗрзЯрж╛рж░ ржХрж░рзБржи</button>
                </div>
            </div>
        </header>

        <main id="main-checklist" class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl p-4 sm:p-6">
            <div id="tab-nav" class="flex flex-wrap justify-center gap-2 mb-6">
                <button data-tab="from_agency" class="tab-button text-sm sm:text-base font-semibold py-2 px-3 rounded-lg border-2 transition-all duration-300">ЁЯОБ ржЖржорж╛ржжрзЗрж░ ржкржХрзНрж╖ ржерзЗржХрзЗ</button>
                <button data-tab="essentials" class="tab-button text-sm sm:text-base font-semibold py-2 px-3 rounded-lg border-2 transition-all duration-300">ржЕрждрзНржпрж╛ржмрж╢рзНржпржХрзАрзЯ</button>
                <button data-tab="general" class="tab-button text-sm sm:text-base font-semibold py-2 px-3 rounded-lg border-2 transition-all duration-300">рж╕ржмрж╛рж░ ржЬржирзНржп</button>
                <button data-tab="men" class="tab-button text-sm sm:text-base font-semibold py-2 px-3 rounded-lg border-2 transition-all duration-300">ржкрзБрж░рзБрж╖ржжрзЗрж░ ржЬржирзНржп</button>
                <button data-tab="women" class="tab-button text-sm sm:text-base font-semibold py-2 px-3 rounded-lg border-2 transition-all duration-300">ржорж╣рж┐рж▓рж╛ржжрзЗрж░ ржЬржирзНржп</button>
                <button data-tab="newborn" class="tab-button text-sm sm:text-base font-semibold py-2 px-3 rounded-lg border-2 transition-all duration-300">ржиржмржЬрж╛рждржХ</button>
                <button data-tab="child" class="tab-button text-sm sm:text-base font-semibold py-2 px-3 rounded-lg border-2 transition-all duration-300">рж╢рж┐рж╢рзБ (рзи-рззрзн)</button>
                <button data-tab="elderly" class="tab-button text-sm sm:text-base font-semibold py-2 px-3 rounded-lg border-2 transition-all duration-300">ржмрзЯрзЛржЬрзНржпрзЗрж╖рзНржа</button>
                <button data-tab="medicine" class="tab-button text-sm sm:text-base font-semibold py-2 px-3 rounded-lg border-2 transition-all duration-300">ржФрж╖ржз</button>
                <button data-tab="optional" class="tab-button text-sm sm:text-base font-semibold py-2 px-3 rounded-lg border-2 transition-all duration-300">ржРржЪрзНржЫрж┐ржХ</button>
            </div>

            <div id="tab-content">
                 <div id="from_agency" class="content-panel"></div>
                 <div id="essentials" class="content-panel"></div>
                 <div id="general" class="content-panel"></div>
                 <div id="men" class="content-panel"></div>
                 <div id="women" class="content-panel"></div>
                 <div id="newborn" class="content-panel"></div>
                 <div id="child" class="content-panel"></div>
                 <div id="elderly" class="content-panel"></div>
                 <div id="medicine" class="content-panel"></div>
                 <div id="optional" class="content-panel"></div>
            </div>
        </main>
        
        <section id="checked-items-summary" class="mt-8 bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl p-4 sm:p-6 hidden">
            <h3 class="text-2xl font-bold text-gray-800 mb-4 border-b-2 border-gray-800 pb-2">тЬЕ ржЖржкржирж╛рж░ ржЧрзЛржЫрж╛ржирзЛ ржЖржЗржЯрзЗржорж╕ржорзВрж╣</h3>
            <div id="checked-list-container"></div>
            <div class="mt-6 p-4 border-t border-gray-200">
                <h3 class="font-bold text-lg text-gray-700 mb-3 text-center">ржирж┐рж░рзНржмрж╛ржЪрж┐ржд рждрж╛рж▓рж┐ржХрж╛</h3>
                <div id="checked-list-actions" class="flex justify-center flex-wrap gap-3">
                    <button data-type="checked" data-format="pdf" class="action-button download-btn">ржбрж╛ржЙржирж▓рзЛржб (PDF)</button>
                    <button data-type="checked" data-format="jpg" class="action-button download-btn">ржбрж╛ржЙржирж▓рзЛржб (JPG)</button>
                    <button data-type="checked" class="action-button print-btn">ржкрзНрж░рж┐ржирзНржЯ ржХрж░рзБржи</button>
                    <button data-type="checked" class="action-button share-btn">рж╢рзЗрзЯрж╛рж░ ржХрж░рзБржи</button>
                </div>
            </div>
        </section>

        <footer class="text-center mt-8 bg-gray-800 text-white rounded-2xl p-6">
            <h4 class="font-bold text-xl">ржЖржкржирж╛рж░ ржЙржорж░рж╛рж╣ ржпрж╛рждрзНрж░рж╛ рж╣рзЛржХ ржирж┐рж░рж╛ржкржж ржУ ржХржмрзБрж▓ржпрзЛржЧрзНржп</h4>
            <div class="mt-4 text-gray-300">
                <p class="font-semibold text-lg">ржЖрж▓-рж╣рж┐ржХржорж╛рж╣ ржЯрзНржпрзБрж░ ржЕрзНржпрж╛ржирзНржб ржЯрзНрж░рж╛ржнрзЗрж▓рж╕</p>
                <p>ржпрзЛржЧрж╛ржпрзЛржЧ: +8801914137050 (WhatsApp) | ржЗржорзЗржЗрж▓: alhikmahtourbd@gmail.com</p>
            </div>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const { jsPDF } = window.jspdf;
            
            const checklistData = {
                from_agency: { title: 'ЁЯОБ ржЖрж▓-рж╣рж┐ржХржорж╛рж╣ ржПрж░ ржкржХрзНрж╖ ржерзЗржХрзЗ', items: [
                    { name: '*ржнрж┐рж╕рж╛рж░ рж╣рж╛рж░рзНржбржХржкрж┐', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: '*ржЯрж┐ржХрж┐ржЯрзЗрж░ рж╣рж╛рж░рзНржбржХржкрж┐', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: '*ржПржХржЯрж┐ ржЖржЗржбрж┐ ржХрж╛рж░рзНржб', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: '*ржкрж┐ржарзЗ ржЭрзБрж▓рж╛ржирзЛрж░ ржжрзБржЗ ржЪрзЗржорзНржмрж╛рж░рзЗрж░ ржмрзНржпрж╛ржЧ', bag: 'рж╕рж╛ржерзЗ ржерж╛ржХржмрзЗ' },
                    { name: '*рж▓рж╛ржЧрзЗржЬ ржЯрзНржпрж╛ржЧ рж╕рзНржЯрж┐ржХрж╛рж░', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: '*ржУржорж░рж╛ ржкрж╛рж▓ржирзЗрж░ ржирж┐ржпрж╝ржорж╛ржмрж▓рж┐ ржмржЗ', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' }
                ]},
                essentials: { title: 'ЁЯУД ржЕрждрзНржпрж╛ржмрж╢рзНржпржХрзАрзЯ ржиржерж┐ ржУ ржЕрж░рзНрже', items: [
                    { name: '*ЁЯЫВ ржкрж╛рж╕ржкрзЛрж░рзНржЯ ржУ ржнрж┐рж╕рж╛ (ржлржЯрзЛржХржкрж┐рж╕рж╣)', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: '*тЬИя╕П ржмрж┐ржорж╛ржирзЗрж░ ржЯрж┐ржХрж┐ржЯ (ржкрзНрж░рж┐ржирзНржЯ ржУ ржбрж┐ржЬрж┐ржЯрж╛рж▓ ржХржкрж┐)', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: '*ЁЯТ│ ржирзНржпрж╛рж╢ржирж╛рж▓ ржЖржЗржбрж┐ ржХрж╛рж░рзНржб (ржлржЯрзЛржХржкрж┐рж╕рж╣) (ржЕржлрж┐рж╕ ржкрзНрж░ржжрждрзНржд)', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: '*ржкрзБрж░рж╛рждржи ржкрж╛рж╕ржкрзЛрж░рзНржЯ (ржпржжрж┐ ржерж╛ржХрзЗ)', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯЦ╝я╕П ржкрж╛рж╕ржкрзЛрж░рзНржЯ рж╕рж╛ржЗржЬрзЗрж░ ржЫржмрж┐ (рззрзж-рззрзи ржХржкрж┐)', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: '*ЁЯТ╡ рж╕рзМржжрж┐ рж░рж┐рзЯрж╛рж▓ ржУ ржЖржирзНрждрж░рзНржЬрж╛рждрж┐ржХ ржХрж╛рж░рзНржб', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: '*ЁЯП╖я╕П рж▓рж╛ржЧрзЗржЬ ржЯрзНржпрж╛ржЧ (ржирж╛ржо, ржарж┐ржХрж╛ржирж╛ рж╕рж╣) (ржЕржлрж┐рж╕ ржкрзНрж░ржжрждрзНржд)', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'тШОя╕П ржПржЬрзЗржирзНрж╕рж┐ ржУ рж╣рзЛржЯрзЗрж▓рзЗрж░ ржпрзЛржЧрж╛ржпрзЛржЧ рждржерзНржп', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' }
                ]},
                general: { title: 'ЁЯОТ рж╕ржмрж╛рж░ ржЬржирзНржп рж╕рж╛ржзрж╛рж░ржг ржмрзНржпржмрж╣рж╛рж░рзНржп', items: [
                    { name: '*ЁЯСЬ ржЫрзЛржЯ ржХрж╛ржБржзрзЗрж░ ржмрзНржпрж╛ржЧ (ржЕржлрж┐рж╕ ржкрзНрж░ржжрждрзНржд)', bag: 'рж╕рж╛ржерзЗ ржерж╛ржХржмрзЗ' },
                    { name: '*ЁЯУ▒ ржорзЛржмрж╛ржЗрж▓, ржЪрж╛рж░рзНржЬрж╛рж░ ржУ ржкрж╛ржУрзЯрж╛рж░ ржмрзНржпрж╛ржВржХ', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: '*ржЯрзНрж░рж▓рж┐/рж▓рж╛ржЧрзЗржЬ ржмрзНржпрж╛ржЧ', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯФМ ржЗржЙржирж┐ржнрж╛рж░рзНрж╕рж╛рж▓ ржЯрзНрж░рзНржпрж╛ржнрзЗрж▓ ржЕрзНржпрж╛ржбрж╛ржкрзНржЯрж╛рж░', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯз╝ ржЧрзЛрж╕рж▓рзЗрж░ рж╕рж╛ржмрж╛ржи (рж╕рзБржЧржирзНржзрж┐ржмрж┐рж╣рзАржи)', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯз┤ рж╢рзНржпрж╛ржорзНржкрзБ, ржЯрзБржержкрзЗрж╕рзНржЯ, ржмрзНрж░рж╛рж╢', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯз┤ ржнрзНржпрж╛рж╕рж▓рж┐ржи/рж▓рж┐ржкржЬрзЗрж▓', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯТз ржЫрзЛржЯ ржкрж╛ржирж┐рж░ ржмрзЛрждрж▓ (ржЦрж╛рж▓рж┐)', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯНк рж╣рж╛рж▓ржХрж╛ рж╢рзБржХржирзЛ ржЦрж╛ржмрж╛рж░', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯХМ ржЫрзЛржЯ ржЬрж╛рзЯржирж╛ржорж╛ржЬ', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'тШВя╕П ржЫрзЛржЯ ржЫрж╛рждрж╛ ржУ ЁЯХ╢я╕П рж╕рж╛ржиржЧрзНрж▓рж╛рж╕', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯЪ╜ ржЯржпрж╝рж▓рзЗржЯ ржкрзЗржкрж╛рж░', bag: 'рж▓рж╛ржЧрзЗржЬ' }
                ]},
                men: { title: 'ЁЯзФЁЯП╗ рж╢рзБржзрзБ ржкрзБрж░рзБрж╖ржжрзЗрж░ ржЬржирзНржп', items: [
                    { name: '*ЁЯП│я╕П ржЗрж╣рж░рж╛ржорзЗрж░ ржХрж╛ржкрзЬ (ржХржоржкржХрзНрж╖рзЗ рзи рж╕рзЗржЯ)', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯТ░ ржЗрж╣рж░рж╛ржорзЗрж░ ржмрзЗрж▓рзНржЯ (ржкржХрзЗржЯрж╕рж╣)', bag: 'рж╕рж╛ржерзЗ ржерж╛ржХржмрзЗ' },
                    { name: '*ЁЯй┤ ржлрж┐рждрж╛ржпрзБржХрзНржд ржЦрзЛрж▓рж╛ рж╕рзНржпрж╛ржирзНржбрзЗрж▓', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯСХ рж╕рж╛ржзрж╛рж░ржг ржкрзЛрж╢рж╛ржХ (рзи-рзй рж╕рзЗржЯ)', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'тЬВя╕П ржЫрзЛржЯ ржХрж╛ржБржЪрж┐ ржмрж╛ ржирзЗржЗрж▓ ржХрж╛ржЯрж╛рж░', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯФк ржмрзНрж▓рзЗржб/рж░рзЗржЬрж╛рж░ (ржЗрж╣рж░рж╛ржо рж╢рзЗрж╖рзЗ)', bag: 'рж▓рж╛ржЧрзЗржЬ' }
                ]},
                women: { title: 'ЁЯзХЁЯП╗ рж╢рзБржзрзБ ржорж╣рж┐рж▓рж╛ржжрзЗрж░ ржЬржирзНржп', items: [
                    { name: '*ЁЯзХ ржЖржмрж╛рзЯрж╛ ржУ рж╣рж┐ржЬрж╛ржм (рзи-рзй рж╕рзЗржЯ)', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯзд рж╣рж╛ржд ржорзЛржЬрж╛ ржУ ржкрж╛ ржорзЛржЬрж╛', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: '*ЁЯСЯ ржЖрж░рж╛ржоржжрж╛рзЯржХ ржЬрзБрждрж╛/рж╕рзНржпрж╛ржирзНржбрзЗрж▓', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯй╕ рж╕рзНржпрж╛ржирж┐ржЯрж╛рж░рж┐ ржирзНржпрж╛ржкржХрж┐ржи/ржкрзНржпрж╛ржб', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯз╖ рж╕рзЗржлржЯрж┐ржкрж┐ржи ржУ рж╣рж┐ржЬрж╛ржм ржкрж┐ржи', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯСЧ рж╣рзЛржЯрзЗрж▓рзЗ ржкрж░рж╛рж░ ржЬржирзНржп рж╕рж╛ржзрж╛рж░ржг ржкрзЛрж╢рж╛ржХ', bag: 'рж▓рж╛ржЧрзЗржЬ' }
                ]},
                newborn: { title: 'ЁЯС╢ ржиржмржЬрж╛рждржХрзЗрж░ ржЬржирзНржп', items: [
                    { name: '*ржкрж░рзНржпрж╛ржкрзНржд ржбрж╛рзЯрж╛ржкрж╛рж░ ржУ ржУрзЯрзЗржЯ ржЯрж┐рж╕рзНржпрзБ', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: '*ржлрж┐ржбрж┐ржВ ржмрзЛрждрж▓ ржУ ржлрж░рзНржорзБрж▓рж╛ ржжрзБржз', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: '*рж╢рж┐рж╢рзБржХрзЗ ржмрж╣ржирзЗрж░ ржЬржирзНржп ржмрзЗржмрж┐ ржХрзНржпрж╛рж░рж┐рзЯрж╛рж░', bag: 'рж╕рж╛ржерзЗ ржерж╛ржХржмрзЗ' },
                    { name: 'ржирж░ржо ржУ ржкрж╛рждрж▓рж╛ ржХрж╛ржБржерж╛', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'рж╢рж┐рж╢рзБрж░ ржЬржирзНржп ржирж┐рж░рж╛ржкржж рж╕рж╛ржмрж╛ржи/рж╢рзНржпрж╛ржорзНржкрзБ', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ржЕрждрж┐рж░рж┐ржХрзНржд ржирж░ржо ржХрж╛ржкрзЬ (ржХрзЯрзЗржХ рж╕рзЗржЯ)', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ржЫрзЛржЯ ржЦрзЗрж▓ржирж╛ ржмрж╛ ржЪрзБрж╖ржирж┐', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' }
                ]},
                child: { title: 'ЁЯСз рж╢рж┐рж╢рзБ (рзи-рззрзн) ржПрж░ ржЬржирзНржп', items: [
                    { name: '*ржЖрж░рж╛ржоржжрж╛рзЯржХ ржЬрзБрждрж╛ ржмрж╛ рж╕рзНржпрж╛ржирзНржбрзЗрж▓', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ржЗрж╕рж▓рж╛ржорж┐ржХ ржЧрж▓рзНржкрзЗрж░ ржмржЗ', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ржкржЫржирзНржжрзЗрж░ рж╢рзБржХржирзЛ ржЦрж╛ржмрж╛рж░ ржмрж╛ рж╕рзНржирзНржпрж╛ржХрж╕', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ржирж┐ржЬрзЗрж░ ржЬрж┐ржирж┐рж╕ рж░рж╛ржЦрж╛рж░ ржЬржирзНржп ржЫрзЛржЯ ржмрзНржпрж╛ржЧ', bag: 'рж╕рж╛ржерзЗ ржерж╛ржХржмрзЗ' },
                    { name: 'рж╕рж╛ржзрж╛рж░ржг ржФрж╖ржзржкрждрзНрж░ (ржкрзНржпрж╛рж░рж╛рж╕рж┐ржЯрж╛ржорж▓)', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'рж░рзЛржж ржерзЗржХрзЗ ржмрж╛ржБржЪрж╛рж░ ржЬржирзНржп ржЯрзБржкрж┐', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' }
                ]},
                elderly: { title: 'ЁЯС┤ ржмрзЯрзЛржЬрзНржпрзЗрж╖рзНржаржжрзЗрж░ ржЬржирзНржп', items: [
                    { name: '*рж╕ржм ржирж┐рзЯржорж┐ржд ржФрж╖ржз (ржбрж╛ржХрзНрждрж╛рж░рзЗрж░ ржмрзНржпржмрж╕рзНржерж╛ржкрждрзНрж░ рж╕рж╣)', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'рж╣рж╛ржБржЯрж╛рж░ ржЬржирзНржп рж▓рж╛ржарж┐ ржмрж╛ рж╣рзБржЗрж▓ржЪрзЗрзЯрж╛рж░', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'рж╣рж╛ржБржЯрзБ ржмрж╛ ржЧрзЛрзЬрж╛рж▓рж┐рж░ рж╕рж╛ржкрзЛрж░рзНржЯ/ржЕрзНржпрж╛ржЩрзНржХрж▓рзЗржЯ', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'рж╕рж╣ржЬрзЗ рж╣ржЬржо рж╣рзЯ ржПржоржи ржЦрж╛ржмрж╛рж░', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ржкрж░рж┐ржмрж╛рж░рзЗрж░ ржЬрж░рзБрж░рж┐ ржпрзЛржЧрж╛ржпрзЛржЧрзЗрж░ ржиржорзНржмрж░', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: '*ржирж░ржо ржУ ржЖрж░рж╛ржоржжрж╛рзЯржХ ржЬрзБрждрж╛ (ржиржи-рж╕рзНрж▓рж┐ржк)', bag: 'рж▓рж╛ржЧрзЗржЬ' }
                ]},
                medicine: { title: 'ЁЯПе ржФрж╖ржз ржУ ржкрзНрж░рж╛ржержорж┐ржХ ржЪрж┐ржХрж┐рзОрж╕рж╛', items: [
                    { name: 'ЁЯТК рж╕рж╛ржзрж╛рж░ржг ржФрж╖ржз (ржкрзНржпрж╛рж░рж╛рж╕рж┐ржЯрж╛ржорж▓, ржЧрзНржпрж╛рж╕рзНржЯрзНрж░рж┐ржХ, рж╕рзНржпрж╛рж▓рж╛ржЗржи)', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯй╣ ржмрзНржпрж╛ржирзНржбрзЗржЬ ржУ ржЕрзНржпрж╛ржирзНржЯрж┐рж╕рзЗржкржЯрж┐ржХ', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: '*ЁЯй║ ржмрзНржпржХрзНрждрж┐ржЧржд ржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржФрж╖ржз (ржкрзНрж░рзЗрж╕ржХрзНрж░рж┐ржкрж╢ржи рж╕рж╣)', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' }
                ]},
                optional: { title: 'тЬи ржРржЪрзНржЫрж┐ржХ ржХрж┐ржирзНрждрзБ ржЙржкржХрж╛рж░рзА', items: [
                    { name: 'ЁЯУЦ ржЫрзЛржЯ ржХрзБрж░ржЖржи рж╢рж░рзАржл ржУ ржжрзЛрзЯрж╛рж░ ржмржЗ (ржЕржлрж┐рж╕ ржкрзНрж░ржжрждрзНржд)', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯУ┐ рждрж╕ржмрж┐рж╣', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'тЬТя╕П ржбрж╛рзЯрзЗрж░рж┐ ржУ ржХрж▓ржо', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯТж рж╕рзНржкрзНрж░рзЗ ржмрзЛрждрж▓ (ржЕржЬрзБрж░ ржЬржирзНржп)', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯз╡ рж╕рзБржЗ-рж╕рзБрждрж╛', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯЫНя╕П ржнрж╛ржБржЬ ржХрж░рж╛ ржпрж╛рзЯ ржПржоржи ржмрзНржпрж╛ржЧ', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯТ╡ ржХрж┐ржЫрзБ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзА ржЯрж╛ржХрж╛', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯз┤ рж╕рж╛ржирж╕рзНржХрзНрж░рж┐ржи (рждрзНржмржХрзЗрж░ ржзрж░ржи ржЕржирзБржпрж╛рзЯрзА)', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯШ┤ ржирзЗржХ ржкрж┐рж▓рзЛ', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯТи ржкрзЛрж░рзНржЯрзЗржмрж▓ ржлрзНржпрж╛ржи', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯФТ ржЫрзЛржЯ рждрж╛рж▓рж╛ (рж▓рж╛ржЧрзЗржЬрзЗрж░ ржЬржирзНржп)', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯТз ржкрж╛ржирж┐рж░рзЛржзрзА ржмрзНржпрж╛ржЧ (ржорзЛржмрж╛ржЗрж▓/ржЯрж╛ржХрж╛рж░ ржЬржирзНржп)', bag: 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' },
                    { name: 'ЁЯФк ржлрж▓ ржХрж╛ржЯрж╛рж░ ржЫрзБрж░рж┐', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯН╜я╕П ржкрзНрж▓рзЗржЯ, ржЧрзНрж▓рж╛рж╕, ржЪрж╛ржоржЪ, ржоржЧ', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯз╝ ржХрж╛ржкрзЬ ржХрж╛ржЪрж╛рж░ рж╕рж╛ржмрж╛ржи', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯОЧя╕П ржХрж╛ржкрзЬ рж╢рзБржХрж╛ржирзЛрж░ рж░рж╢рж┐', bag: 'рж▓рж╛ржЧрзЗржЬ' },
                    { name: 'ЁЯй╣ рж╕рж╛рж░рзНржЬрж┐ржХрзНржпрж╛рж▓ ржЯрзЗржк', bag: 'рж▓рж╛ржЧрзЗржЬ' }
                ]}
            };

            function renderChecklists() {
                for (const category in checklistData) {
                    const panel = document.getElementById(category);
                    const data = checklistData[category];
                    let html = `
                        <h3 class="text-xl font-bold text-gray-700 mb-4 border-b-2 border-indigo-200 pb-2">${data.title}</h3>
                        <div class="checklist-item flex items-center mb-4 border-b pb-2">
                            <input id="select-all-${category}" type="checkbox" class="h-5 w-5 rounded border-gray-400 text-indigo-600 focus:ring-indigo-500 mr-3 select-all-checkbox" data-category="${category}">
                            <label for="select-all-${category}" class="text-gray-800 font-semibold">рж╕ржмржЧрзБрж▓рзЛ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи</label>
                        </div>
                        <ul class="space-y-3">`;
                    data.items.forEach((item, index) => {
                        const itemId = `${category}-${index}`;
                        const isEssential = item.name.startsWith('*');
                        const cleanItem = isEssential ? item.name.substring(1) : item.name;
                        const labelClass = isEssential ? 'essential-item' : '';
                        const starIcon = isEssential ? '<span class="text-red-500 mr-1">тШЕ</span>' : '';
                        const bagTagClass = item.bag === 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' || item.bag === 'рж╕рж╛ржерзЗ ржерж╛ржХржмрзЗ' ? 'bag-hand' : 'bag-luggage';

                        html += `
                            <li class="checklist-item flex items-center justify-between">
                                <div class="flex items-center">
                                    <input id="${itemId}" type="checkbox" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 mr-3 item-checkbox" data-category="${category}" data-title="${data.title}" data-essential="${isEssential}" data-bag="${item.bag}">
                                    <label for="${itemId}" class="text-gray-700 flex items-center ${labelClass}">${starIcon} ${cleanItem}</label>
                                </div>
                                <span class="bag-tag ${bagTagClass}">${item.bag}</span>
                            </li>`;
                    });
                    html += '</ul>';
                    panel.innerHTML = html;
                }
            }

            function updateCheckedState() {
                const checkedItemsByCat = {};
                document.querySelectorAll('.item-checkbox:checked').forEach(cb => {
                    const categoryTitle = cb.dataset.title;
                    if (!checkedItemsByCat[categoryTitle]) checkedItemsByCat[categoryTitle] = [];
                    const labelContent = cb.nextElementSibling.innerHTML;
                    const bagTag = cb.closest('li').querySelector('.bag-tag').outerHTML;
                    checkedItemsByCat[categoryTitle].push({label: labelContent, bag: bagTag});
                });

                const container = document.getElementById('checked-list-container');
                const summarySection = document.getElementById('checked-items-summary');
                container.innerHTML = '';
                
                if (Object.keys(checkedItemsByCat).length > 0) {
                    for (const categoryTitle in checkedItemsByCat) {
                        let categoryHtml = `<h4 class="checked-category-title">${categoryTitle}</h4><ul class="space-y-2 list-disc list-inside text-gray-700 pl-4">`;
                        checkedItemsByCat[categoryTitle].forEach(item => {
                            categoryHtml += `<li class="flex justify-between items-center">${item.label}${item.bag}</li>`;
                        });
                        categoryHtml += `</ul>`;
                        container.innerHTML += categoryHtml;
                    }
                    summarySection.classList.remove('hidden');
                } else {
                    summarySection.classList.add('hidden');
                }
            }

            function handleSelectAll(e) {
                const category = e.target.dataset.category;
                document.querySelectorAll(`.item-checkbox[data-category="${category}"]`).forEach(cb => {
                    cb.checked = e.target.checked;
                });
                updateCheckedState();
            }
            
            function handleItemCheck(e) {
                const category = e.target.dataset.category;
                const itemCheckboxes = document.querySelectorAll(`.item-checkbox[data-category="${category}"]`);
                document.getElementById(`select-all-${category}`).checked = Array.from(itemCheckboxes).every(cb => cb.checked);
                updateCheckedState();
            }

            function switchTab(tab) {
                document.querySelectorAll('.tab-button').forEach(t => t.classList.replace('tab-active', 'tab-inactive'));
                tab.classList.replace('tab-inactive', 'tab-active');
                document.querySelectorAll('.content-panel').forEach(panel => panel.classList.remove('active'));
                document.getElementById(tab.dataset.tab).classList.add('active');
            }

            async function performAction(button, action) {
                const type = button.dataset.type;
                const format = button.dataset.format;
                const contentGenerator = type === 'full' ? generateFullListHTML : generateCheckedListHTML;
                const baseFilename = type === 'full' ? 'Umrah_Full_Checklist' : 'My_Umrah_Packed_Items';

                button.disabled = true;
                const originalText = button.textContent;
                button.textContent = 'ржкрзНрж░рж╕рзЗрж╕рж┐ржВ...';

                const printableArea = document.createElement('div');
                printableArea.className = 'printable-area';
                
                const contentHTML = contentGenerator();
                if (!contentHTML) {
                    alert('ржкрзНрж░ржержорзЗ рждрж╛рж▓рж┐ржХрж╛ ржерзЗржХрзЗ ржХрж┐ржЫрзБ ржЖржЗржЯрзЗржо ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржиред');
                    button.disabled = false;
                    button.textContent = originalText;
                    return;
                }
                
                await createPrintableContent(printableArea, contentHTML);
                document.body.appendChild(printableArea);
                
                const watermarkDataUrl = await createWatermarkWithLogo();
                printableArea.innerHTML += `<div class="watermark-container" style="background-image: ${watermarkDataUrl}"></div>`;

                try {
                    const canvas = await html2canvas(printableArea, { scale: 2, useCORS: true, backgroundColor: '#ffffff' });
                    
                    if (action === 'download') {
                        const customerName = document.getElementById('customer-name').value.trim().replace(/\s+/g, '_') || 'Guest';
                        const filename = `${baseFilename}_${customerName}`;
                        if (format === 'jpg') {
                            const link = document.createElement('a');
                            link.href = canvas.toDataURL('image/jpeg', 0.95);
                            link.download = `${filename}.jpg`;
                            link.click();
                        } else if (format === 'pdf') {
                            const imgData = canvas.toDataURL('image/png');
                            const pdf = new jsPDF({ orientation: 'p', unit: 'px', format: [canvas.width, canvas.height] });
                            pdf.addImage(imgData, 'PNG', 0, 0, canvas.width, canvas.height, undefined, 'FAST');
                            pdf.save(`${filename}.pdf`);
                        }
                    } else if (action === 'print') {
                        const iframe = document.createElement('iframe');
                        iframe.style.position = 'absolute';
                        iframe.style.width = '0';
                        iframe.style.height = '0';
                        iframe.style.border = '0';
                        document.body.appendChild(iframe);
                        
                        const doc = iframe.contentWindow.document;
                        doc.open();
                        doc.write(`<html><head><title>Print</title></head><body><img src="${canvas.toDataURL()}" style="width:100%;"></body></html>`);
                        doc.close();
                        
                        iframe.contentWindow.focus();
                        iframe.contentWindow.print();
                        setTimeout(() => { document.body.removeChild(iframe); }, 1000);

                    } else if (action === 'share') {
                        if (navigator.share) {
                            canvas.toBlob(async function(blob) {
                                const file = new File([blob], `${baseFilename}.jpg`, { type: 'image/jpeg' });
                                try {
                                    await navigator.share({
                                        title: 'ржЖржорж╛рж░ ржЙржорж░рж╛рж╣ ржЪрзЗржХрж▓рж┐рж╕рзНржЯ',
                                        text: 'ржЖрж▓-рж╣рж┐ржХржорж╛рж╣ ржЯрзНржпрзБрж░ ржЕрзНржпрж╛ржирзНржб ржЯрзНрж░рж╛ржнрзЗрж▓рж╕ ржПрж░ рж╕рж╛ржерзЗ ржЖржорж╛рж░ ржЙржорж░рж╛рж╣ ржпрж╛рждрзНрж░рж╛рж░ ржкрзНрж░рж╕рзНрждрзБрждрж┐ред',
                                        files: [file]
                                    });
                                } catch (err) {
                                    console.error('Share failed:', err.message);
                                    if (err.name !== 'AbortError') {
                                        alert('ржжрзБржГржЦрж┐ржд, рж╢рзЗрзЯрж╛рж░ ржХрж░рж╛ рж╕ржорзНржнржм рж╣рзЯржирж┐ред ржЖржкржирж╛рж░ ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржмрж╛ ржмрж░рзНрждржорж╛ржи ржнрж┐ржЙрждрзЗ ржПржЗ ржлрж┐ржЪрж╛рж░ржЯрж┐ рж╕рж╛ржкрзЛрж░рзНржЯ ржирж╛ржУ ржХрж░рждрзЗ ржкрж╛рж░рзЗред');
                                    }
                                }
                            }, 'image/jpeg');
                        } else {
                            alert('ржЖржкржирж╛рж░ ржмрзНрж░рж╛ржЙржЬрж╛рж░ ржПржЗ рж╢рзЗрзЯрж╛рж░ ржлрж┐ржЪрж╛рж░ржЯрж┐ рж╕рж╛ржкрзЛрж░рзНржЯ ржХрж░рзЗ ржирж╛ред');
                        }
                    }
                } catch (error) {
                    console.error('Action failed:', error);
                    alert('ржжрзБржГржЦрж┐ржд, ржПржЗ ржХрж╛ржЬржЯрж┐ рж╕ржорзНржкржирзНржи ржХрж░рж╛ рж╕ржорзНржнржм рж╣рзЯржирж┐ред');
                } finally {
                    document.body.removeChild(printableArea);
                    button.disabled = false;
                    button.textContent = originalText;
                }
            }
            
            async function createPrintableContent(container, contentHTML) {
                const guestName = document.getElementById('customer-name').value.trim() || 'ржЖрж▓рзНрж▓рж╛рж╣рж░ ржШрж░рзЗрж░ ржорзЗрж╣ржорж╛ржи';
                
                const now = new Date();
                const days = ['рж░ржмрж┐ржмрж╛рж░', 'рж╕рзЛржоржмрж╛рж░', 'ржоржЩрзНржЧрж▓ржмрж╛рж░', 'ржмрзБржзржмрж╛рж░', 'ржмрзГрж╣рж╕рзНржкрждрж┐ржмрж╛рж░', 'рж╢рзБржХрзНрж░ржмрж╛рж░', 'рж╢ржирж┐ржмрж╛рж░'];
                const dayName = days[now.getDay()];
                const dateString = now.toLocaleDateString('bn-BD', { year: 'numeric', month: 'long', day: 'numeric' });

                const qrData = encodeURIComponent('MECARD:N:Al-Hikmah Tour & Travels;TEL:+8801914137050;EMAIL:alhikmahtourbd@gmail.com;;');
                const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${qrData}`;
                
                const logoUrl = 'https://raw.githubusercontent.com/NaeemNajm/pic/refs/heads/main/logo.png';

                const header = `
                    <div class="printable-header" style="border-bottom: 3px solid #4C51BF; display:flex; justify-content:space-between; align-items:center;">
                        <img id="printable-logo" src="${logoUrl}" alt="Company Logo" crossorigin="anonymous" style="height: 50px;">
                        <div style="text-align: right;">
                            <h1 style="color: #4C51BF; font-size: 32px; margin:0;">ржЖрж▓-рж╣рж┐ржХржорж╛рж╣ ржЯрзНржпрзБрж░ ржЕрзНржпрж╛ржирзНржб ржЯрзНрж░рж╛ржнрзЗрж▓рж╕</h1>
                            <p style="font-size: 14px; color: #718096; margin:0;">ржЖржкржирж╛рж░ ржмрж┐рж╢рзНржмрж╕рзНржд ржнрзНрж░ржоржг рж╕ржЩрзНржЧрзА</p>
                        </div>
                    </div>
                    <div style="text-align:center; margin: 20px 0;">
                        <h2 style="font-size: 24px; font-weight: 700; color: #2C5282;">ржкржмрж┐рждрзНрж░ ржЙржорж░рж╛рж╣ ржпрж╛рждрзНрж░рж╛рж░ ржЪрзЗржХрж▓рж┐рж╕рзНржЯ</h2>
                        <p style="font-size: 16px; color: #DD6B20; margin-top: 8px;">ржкрзНрж░рж┐рзЯ ${guestName},<br>ржЖржкржирж╛рж░ ржкржмрж┐рждрзНрж░ рж╕ржлрж░рзЗрж░ ржкрзНрж░рж╕рзНрждрзБрждрж┐рждрзЗ рж╕ржЩрзНржЧрзА рж╣рждрзЗ ржкрзЗрж░рзЗ ржЖржорж░рж╛ ржЖржиржирзНржжрж┐рждред ржорж╣рж╛ржи ржЖрж▓рзНрж▓рж╛рж╣ ржЖржкржирж╛рж░ ржкрзНрж░рждрж┐ржЯрж┐ ржкржжржХрзНрж╖рзЗржк ржХржмрзБрж▓ ржХрж░рзБржи ржПржмржВ ржПржЗ ржпрж╛рждрзНрж░рж╛ ржЖржкржирж╛рж░ ржЬрзАржмржирзЗрж░ рж╕рзЗрж░рж╛ рж╕рзНржорзГрждрж┐ рж╣рзЯрзЗ ржерж╛ржХрзБржХред</p>
                        <p style="font-size: 14px; color: #718096; margin-top: 15px;">рждрзИрж░рж┐рж░ рждрж╛рж░рж┐ржЦ: ${dateString}, ${dayName}</p>
                    </div>
                    <div style="background-color: #FEFCE8; border-left: 4px solid #FBBF24; color: #92400E; padding: 12px; margin: 20px 0; font-size: 14px; text-align: center; column-span: all;">
                        <b>ржмрж┐рж╢рзЗрж╖ ржжрзНрж░рж╖рзНржЯржмрзНржп:</b> рж╕ржлрж░рзЗ ржпржд ржХржо рд╕рд╛рдорд╛рди, рждржд ржмрзЗрж╢рж┐ ржЖрж░рж╛ржоред ржЖржкржирж╛рж░ ржкрзНрж░рзЯрзЛржЬржи ржЕржирзБржпрж╛рзЯрзА ржЬрж┐ржирж┐рж╕ржкрждрзНрж░ ржирж┐ржи ржПржмржВ ржЕрждрж┐рж░рж┐ржХрзНржд ржорж╛рж▓рж╛ржорж╛рж▓ ржмрж╣ржи ржХрж░рж╛ ржерзЗржХрзЗ ржмрж┐рж░ржд ржерж╛ржХрзБржиред
                    </div>
                    `;
                const footer = `
                    <div class="printable-footer" style="border-top: 2px solid #4C51BF; display: flex; align-items: center; justify-content: space-between; padding-top: 15px;">
                        <div style="text-align: left;">
                            <h1 style="font-size: 20px; color: #4C51BF;">ржЖржкржирж╛рж░ ржпрж╛рждрзНрж░рж╛ ржирж┐рж░рж╛ржкржж ржУ ржХржмрзБрж▓ржпрзЛржЧрзНржп рж╣рзЛржХ</h1>
                            <p style="color: #4A5568;">ржпрзЗржХрзЛржирзЛ ржкрзНрж░рзЯрзЛржЬржирзЗ ржЖржорж░рж╛ ржЖржЫрж┐ ржЖржкржирж╛рж░ ржкрж╛рж╢рзЗред</p>
                        </div>
                        <div>
                            <img id="printable-qr" src="${qrUrl}" alt="QR Code" crossorigin="anonymous" style="width: 80px; height: 80px;">
                        </div>
                    </div>`;
                
                container.innerHTML = `<div class="printable-content-wrapper">${header}<div class="printable-content">${contentHTML}</div>${footer}</div>`;
                
                const logoImg = container.querySelector('#printable-logo');
                const qrImg = container.querySelector('#printable-qr');
                const promises = [
                    new Promise(resolve => { logoImg.onload = resolve; logoImg.onerror = resolve; }),
                    new Promise(resolve => { qrImg.onload = resolve; qrImg.onerror = resolve; })
                ];
                await Promise.all(promises);
            }

            async function createWatermarkWithLogo() {
                return new Promise((resolve) => {
                    const logo = new Image();
                    logo.crossOrigin = "anonymous";
                    logo.src = 'https://raw.githubusercontent.com/NaeemNajm/pic/refs/heads/main/logo.png';

                    logo.onload = () => {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        canvas.width = 400;
                        canvas.height = 300;

                        ctx.globalAlpha = 0.04;
                        ctx.fillStyle = '#4C51BF';
                        ctx.font = 'bold 18px Hind Siliguri';
                        ctx.textAlign = 'center';

                        ctx.translate(canvas.width / 2, canvas.height / 2);
                        ctx.rotate(-Math.PI / 6);
                        ctx.translate(-canvas.width / 2, -canvas.height / 2);

                        ctx.drawImage(logo, 50, 80, 100, 33);
                        ctx.fillText('ржЖрж▓-рж╣рж┐ржХржорж╛рж╣', 250, 100);
                        ctx.fillText('ржЯрзНржпрзБрж░ ржЕрзНржпрж╛ржирзНржб ржЯрзНрж░рж╛ржнрзЗрж▓рж╕', 150, 200);

                        resolve(`url(${canvas.toDataURL()})`);
                    };

                    logo.onerror = () => {
                        console.error("Logo could not be loaded for watermark.");
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        canvas.width = 300;
                        canvas.height = 200;
                        ctx.globalAlpha = 0.05;
                        ctx.fillStyle = '#4C51BF';
                        ctx.font = 'bold 16px Hind Siliguri';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.translate(150, 100);
                        ctx.rotate(-Math.PI / 4);
                        ctx.fillText('ржЖрж▓-рж╣рж┐ржХржорж╛рж╣ ржЯрзНржпрзБрж░ ржЕрзНржпрж╛ржирзНржб ржЯрзНрж░рж╛ржнрзЗрж▓рж╕', 0, 0);
                        resolve(`url(${canvas.toDataURL()})`);
                    };
                });
            }

            function generateFullListHTML() {
                let html = '';
                const categories = Object.keys(checklistData);
                categories.forEach((category, index) => {
                    const data = checklistData[category];
                    const breakClass = index === 5 ? 'list-break' : ''; // Break after 5th category for better balance
                    html += `<div class="${breakClass}" style="page-break-inside: avoid;"><h3 style="font-size: 1.25rem; font-weight: 700; color: #2C5282; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 2px solid #BEE3F8; padding-bottom: 0.5rem;">${data.title}</h3><ul style="list-style-type: none; padding: 0; margin-bottom: 1.5rem;">`;
                    data.items.forEach(item => {
                        const isEssential = item.name.startsWith('*');
                        const cleanItem = isEssential ? item.name.substring(1) : item.name;
                        const starIcon = isEssential ? '<span style="color: #C53030; font-weight: 600;">тШЕ</span>' : 'тШР';
                        const bagTagStyle = `display: inline-flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 500; padding: 2px 8px; border-radius: 9999px; line-height: 1.2; ${item.bag === 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' || item.bag === 'рж╕рж╛ржерзЗ ржерж╛ржХржмрзЗ' ? 'background-color: #EBF4FF; color: #3182CE; border: 1px solid #90CDF4;' : 'background-color: #FEEBC8; color: #DD6B20; border: 1px solid #FBD38D;'}`;
                        html += `<li style="margin-bottom: 0.5rem; color: #4A5568; font-size: 16px; display: flex; justify-content: space-between; align-items: center;"><span>${starIcon} ${cleanItem}</span><span style="${bagTagStyle}">${item.bag}</span></li>`;
                    });
                    html += `</ul></div>`;
                });
                return html;
            }

            function generateCheckedListHTML() {
                const checkedItemsByCat = {};
                 document.querySelectorAll('.item-checkbox:checked').forEach(cb => {
                    const categoryTitle = cb.dataset.title;
                    if (!checkedItemsByCat[categoryTitle]) checkedItemsByCat[categoryTitle] = [];
                    const isEssential = cb.dataset.essential === 'true';
                    const starIcon = isEssential ? '<span style="color: #C53030; font-weight: 600;">тШЕ</span>' : '';
                    const bag = cb.dataset.bag;
                    const bagTagStyle = `display: inline-flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 500; padding: 2px 8px; border-radius: 9999px; line-height: 1.2; ${bag === 'рж╣рзНржпрж╛ржирзНржбржмрзНржпрж╛ржЧ' || bag === 'рж╕рж╛ржерзЗ ржерж╛ржХржмрзЗ' ? 'background-color: #EBF4FF; color: #3182CE; border: 1px solid #90CDF4;' : 'background-color: #FEEBC8; color: #DD6B20; border: 1px solid #FBD38D;'}`;
                    const bagTagHtml = `<span style="${bagTagStyle}">${bag}</span>`;
                    checkedItemsByCat[categoryTitle].push({ text: `${starIcon} ${cb.nextElementSibling.textContent.trim()}`, bagTag: bagTagHtml });
                });

                if (Object.keys(checkedItemsByCat).length === 0) {
                    alert('ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржкрзНрж░ржержорзЗ ржХрж┐ржЫрзБ ржЖржЗржЯрзЗржо ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржиред');
                    return null;
                }
                let html = `<h3 style="font-size: 1.5rem; font-weight: 700; color: #2C5282; margin-bottom: 1.5rem; text-align: center; column-span: all;">тЬЕ ржЖржкржирж╛рж░ ржЧрзЛржЫрж╛ржирзЛ ржЖржЗржЯрзЗржорж╕ржорзВрж╣</h3>`;
                Object.keys(checkedItemsByCat).forEach(categoryTitle => {
                    html += `<div style="page-break-inside: avoid;"><h4 style="font-size: 1.2rem; font-weight: 600; color: #2D3748; margin-top: 1rem; margin-bottom: 0.5rem; border-bottom: 1px solid #CBD5E0; padding-bottom: 0.25rem;">${categoryTitle}</h4><ul style="list-style-type: none; padding: 0; margin-bottom: 1rem;">`;
                    checkedItemsByCat[categoryTitle].forEach(item => {
                        html += `<li style="margin-bottom: 0.5rem; color: #4A5568; font-size: 16px; display: flex; justify-content: space-between; align-items: center;"><span>тШС ${item.text}</span>${item.bagTag}</li>`;
                    });
                    html += `</ul></div>`;
                });
                return html;
            }

            renderChecklists();
            
            document.querySelectorAll('.tab-button').forEach(tab => tab.addEventListener('click', () => switchTab(tab)));
            document.body.addEventListener('change', e => {
                if (e.target.classList.contains('select-all-checkbox')) handleSelectAll(e);
                if (e.target.classList.contains('item-checkbox')) handleItemCheck(e);
            });

            document.querySelectorAll('.download-btn').forEach(btn => btn.addEventListener('click', (e) => performAction(e.currentTarget, 'download')));
            document.querySelectorAll('.print-btn').forEach(btn => btn.addEventListener('click', (e) => performAction(e.currentTarget, 'print')));
            document.querySelectorAll('.share-btn').forEach(btn => btn.addEventListener('click', (e) => performAction(e.currentTarget, 'share')));

            if (document.querySelectorAll('.tab-button').length > 0) {
                switchTab(document.querySelector('.tab-button'));
            }
        });
    </script>
</body>
</html>
